# Hardware design for 3D convolution operation in CNNs

This repository contains a hardware implementation of a 3D convolution operation for Convolutional Neural Networks (CNNs), as specified in the assignment for a hardware design course. The design is implemented in Verilog, includes a testbench for verification, and uses MATLAB for data generation and validation. An Script automates the simulation and verification process.

## Objective

The project implements a hardware module for performing 3D convolution with the following specifications:
- **Inputs**:
  - Activation array: 9×9×3 (8-bit signed integers).
  - Two filters: Each 3×3×3 (8-bit signed integers).
  - Stride: Configurable for 1 or 2.
- **Outputs**: Two output activation maps (32-bit signed integers) corresponding to each filter for both stride configurations.
- **Components**:
  - A specific Multiply-Accumulate (MAC) unit for core computations.
  - A controller to manage data flow and support stride configurations.
- **Verification**: Testbenches validate the outputs against precomputed results generated by MATLAB.
- **Synthesis**: The design is synthesizable for an FPGA platform.

## Repository Structure

```
├── HDL/
│   ├── tb_top.v          # Testbench for the convolution design
│   ├── top.v             # Top-level module
│   ├── datapath.v        # Datapath including MAC unit
│   ├── controller.v      # Controller for data flow and stride handling
│   └── other .v files    # Additional utility modules
├── MATLAB/
│   ├── data_gen.m        # MATLAB script for generating random input data
│   ├── Eval.m            # MATLAB script for output verification
├── Generated_data/       # Directory for generated input/output files
├── run.sh                #  Script to automate simulation and verification
├── report.pdf            # Design report with block diagram, description, and results
└── README.md             # This file
```

## Prerequisites

To run the code, ensure the following tools are installed and accessible in your system PATH:
- **MATLAB**: For data generation and verification.
- **Icarus Verilog (iverilog)**: For compiling Verilog code.
- **FPGA Synthesis Tool** (e.g., Vivado): For synthesizing the design (optional).


## Setup and Running the Code

After downloading the folder,

1. **Make the Python Script Executable**:
   ```bash
   chmod +x run.sh
   ```

3. **Run the Simulation**:
   ```bash
   ./run.sh
   ```
   - When prompted, enter `1` or `2` for the stride value.
   - The script will:
     1. Generate random input data (activations and filter weights) using MATLAB (`data_gen.m`).
     2. Compile and simulate the Verilog design with the specified stride using Icarus Verilog.
     3. Verify the output against precomputed results using MATLAB (`Eval.m`).
   - Outputs are stored in `MATLAB/Generated_data/`.

4. **Expected Output**:
   - The script prints progress messages for each step (data generation, simulation, verification).
   - Successful completion shows: `All steps completed successfully with stride=<value>!`.
   - Simulation logs show: `SIMULATION STARTED WITH STRIDE = <value>`.

## Contributing
This is a student project for educational purposes. Feel free to fork or suggest improvements via pull requests.

## License
This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
